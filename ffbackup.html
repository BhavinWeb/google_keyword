<html>
    <head>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

        <!-- Optional theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">
    <link 
    href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.css" 
    rel="stylesheet"  type='text/css'>
    <style>
      .d-none{
        display: none;
      }
    </style>
</head>
    <body>
       <section class="m-5">
        
            <div class="row ">
                <div class="col-sm-12 text-center">
                    <h1>Keyword search</h1>
                </div>
                <div class="col-sm-12 ">
                    <form  id="shareForm">
                    <div class="container">

                        <div class="col-sm-12 col-md-4 mt-3">
                       
                            <input type="text" name="keyword" class="form-control" placeholder="Keyword" id="keyword"><span class="pull-right">
                      
                        </div>

                        <div class="col-sm-12 col-md-4 mt-3">
                          <select id="location"  name="city" class="form-control">
                           
                          </select>
                            <input type="text" name="city" class="form-control d-none" placeholder="location" id="location"><span class="pull-right">
                         
                        </div>
                        <div class="col-sm-12 col-md-2 mt-3">
                       
                          <input type="number" name="total_result" class="form-control" placeholder="total_result" id="total_result"><span class="pull-right">
                    
                      </div>
                    </form>

                        <div class="col-sm-12 col-md-2  mt-3">
                       
                            <button type="button" onClick="GetyelpData()"  class="btn btn-primary">Search</button>
                         
                        </div>
                       
                        </div>
                    
                </div>
                <div class="col-sm-12 ml-5 text-center d-none" id="please_wait">
                    <span class="text-danger">Please wait......</span>
                </div>

                <div class="col-sm-12 ml-5">

                  <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">Website</th>
                        <th scope="col">Google</th>
                        <th scope="col">Map</th>
                        <th scope="col">Yelp</th>
                        <th scope="col">Houzz</th>
                      </tr>
                    </thead>
                    <tbody id="url">
                      <tr><th scope="row">-</th><td>-</td><td>-</td><td>-</td><td>-</td> </tr>
                   
                    </tbody>
                  </table>


                </div>


                <div class="search_result d-none" style="display: none;">
                   <div class="col-sm-12 ml-5">
                    <h5>Google.com</h5>
                  </div>

                <div class="col-sm-12 mt-3 m-3" id="search_result" style="margin-left: 20px;margin-right: 20px;">
                    <table class="table m-3">
                        <thead>
                          <tr>
                            <th scope="col">#</th>
                            <th scope="col">name</th>
                            <th scope="col">website</th>
                            <th scope="col">Address</th>
                            <th scope="col">Contact</th>
                            <th scope="col">Description</th>
                            <th scope="col">email</th>
                            <th scope="col">geo</th>
                            <th scope="col">logo</th>
                          </tr>
                        </thead>
                        <tbody id="google_list">
                         
                        </tbody>
                      </table>
                </div>

                <div class="col-sm-12 ml-5">
                  <h5>map.com</h5>
              </div>

              <div class="col-sm-12 mt-3 m-3" id="search_result" style="margin-left: 20px;margin-right: 20px;">
                  <table class="table m-3">
                      <thead>
                        <tr>
                          <th scope="col">#</th>
                          <th scope="col">name</th>
                          <th scope="col">website</th>
                          <th scope="col">Address</th>
                          <th scope="col">Contact</th>
                          <th scope="col">Description</th>
                          <th scope="col">email</th>
                          <th scope="col">geo</th>
                          <th scope="col">logo</th>
                        </tr>
                      </thead>
                      <tbody id="map_list">
                       
                      </tbody>
                    </table>
              </div>


              <div class="col-sm-12 ml-5">
                <h5>yelp.com</h5>
            </div>

            <div class="col-sm-12 mt-3 m-3" id="search_result" style="margin-left: 20px;margin-right: 20px;">
                <table class="table m-3">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">name</th>
                        <th scope="col">website</th>
                        <th scope="col">Address</th>
                        <th scope="col">Contact</th>
                        <th scope="col">Description</th>
                        <th scope="col">email</th>
                        <th scope="col">geo</th>
                        <th scope="col">logo</th>
                      </tr>
                    </thead>
                    <tbody id="yelp_list">
                     
                    </tbody>
                  </table>
            </div>

            <div class="col-sm-12 ml-5">
              <h5>houzz.com</h5>
          </div>

          <div class="col-sm-12 mt-3 m-3" id="search_result" style="margin-left: 20px;margin-right: 20px;">
              <table class="table m-3">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">name</th>
                      <th scope="col">website</th>
                      <th scope="col">Address</th>
                      <th scope="col">Contact</th>
                      <th scope="col">Description</th>
                      <th scope="col">email</th>
                      <th scope="col">geo</th>
                      <th scope="col">logo</th>
                    </tr>
                  </thead>
                  <tbody id="houzz_list">
                   
                  </tbody>
                </table>
          </div>
          </div>

            </div>
       </section>
        
    </body>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
    <script>

$( document ).ready(function() {
    get_city();
});

function get_city(){
  $.ajax({
type: "POST",
      contentType: "application/json; charset=utf-8",
      url: "http://127.0.0.1:3001/getCityList",
      success: function (result) {
          // console.log(result.data);
          var select_option = "";
        $.each(result.data, function( index, value ) {
          select_option += "<option value='"+value.name+"'>"+value.name+"</option>";
        });
        $("#location").html(select_option);
      }
 });
}


function get_data(){
  if($("#total_result").val() == 0 ||  $("#keyword").val() == ""){
      alert("some thing wrong!");
  }else{

    $("#please_wait").removeClass('d-none');
$.ajax({
type: "GET",
      contentType: "application/json; charset=utf-8",
      url: "http://127.0.0.1:3001/GetKeywordsData",
       data: {
                'keyword': $("#keyword").val(),
                'location': $("#location").val(),
                'total_result': $("#total_result").val(),
            },
      success: function (result) {
        if(result.data == 1){
          GetmapData();
        }
        
      }
 });

  }


}

function GetmapData(){
  
$.ajax({
type: "GET",
      contentType: "application/json; charset=utf-8",
      url: "http://127.0.0.1:3001/GetmapData",
       data: {
                'keyword': $("#keyword").val(),
                'location': $("#location").val(),
                'total_result': $("#total_result").val(),
            },
      success: function (result) {
        if(result.data == 1){
          GetyelpData();
        }
        
      }
 });

}

function GetyelpData(){
  
  $.ajax({
  type: "GET",
        contentType: "application/json; charset=utf-8",
        url: "http://127.0.0.1:3001/GetyelpData",
         data: {
                  'keyword': $("#keyword").val(),
                  'location': $("#location").val(),
                  'total_result': $("#total_result").val(),
              },
        success: function (result) {
          if(result.data == 1){
            GethouzzData();
          }
          
        }
   });
  
  }
  
  function GethouzzData(){
  
  $.ajax({
  type: "GET",
        contentType: "application/json; charset=utf-8",
        url: "http://127.0.0.1:3001/GethouzzData",
         data: {
                  'keyword': $("#keyword").val(),
                  'location': $("#location").val(),
                  'total_result': $("#total_result").val(),
              },
        success: function (result) {
          if(result.data == 1){
            get_keyword_list();
          }
          
        }
   });
  
  }
  


function get_keyword_list(){

    $.ajax({

        type: "GET",
        contentType: "application/json; charset=utf-8",
        url: "http://127.0.0.1:3001/GetKeywordsdataList",
        data: {
                    'keyword': $("#keyword").val(),
                    'location': $("#location").val(),
                    'total_result': $("#total_result").val(),
                },

        success: function (result) {

          $("#please_wait").addClass('d-none');

          $(".search_result").removeClass('d-none');

          var url = "";

          var google_html = "";
          
          var map_html = "";

          var yelp_html = "";

          var houzz_html = "";

          $.each(result.duplication, function( index, value ) {
              url +='<tr><th scope="row"><a href="'+value.url_rank+'">link</a></th><td>'+value.google_rank+'</td><td>'+value.map_rank+'</td><td>'+value.yelp_rank+'</td><td>'+value.houzz_rank+'</td> </tr>';
          });
         $("#url").html(url);
          $.each(result.google_data, function( index, value ) {

            var result_address = (value.address != "") ? value.address : "-" ;
            var reslut_contact =  (value.contact != "") ? value.contact : "-" ;
            var reslut_email =  (value.email != "") ? value.email : "-" ;
            var reslut_geo =  (value.geo != "") ? value.geo : "-" ;
            var reslut_logo =  (value.logo != "") ? value.logo : "-" ;
           
            google_html += '<tr> <th scope="row">'+(index+1)+'</th> <td>'+value.name+'</td><td><a href="'+value.website +'" target="_blank">Link</a></td><td>'+ result_address +'</td><th>'+reslut_contact+'</th><td>'+value.description+'</td><td>'+reslut_email+'</td><td>'+reslut_geo+'</td><td>'+reslut_logo
+'</td></tr>';
          
          });

          $("#google_list").html(google_html);

          $.each(result.map_data, function( index, value ) {

            var result_address = (value.address != "") ? value.address : "-" ;
            var reslut_contact =  (value.contact != "") ? value.contact : "-" ;
            var reslut_email =  (value.email != "") ? value.email : "-" ;
            var reslut_geo =  (value.geo != "") ? value.geo : "-" ;
            var reslut_logo =  (value.logo != "") ? value.logo : "-" ;
           
            map_html += '<tr> <th scope="row">'+(index+1)+'</th> <td>'+value.name+'</td><td><a href="'+value.website +'" target="_blank">Link</a></td><td>'+ result_address +'</td><th>'+reslut_contact+'</th><td>'+value.description+'</td><td>'+reslut_email+'</td><td>'+reslut_geo+'</td><td>'+reslut_logo
+'</td></tr>';
          
          });

          
          $("#map_list").html(map_html);


          $.each(result.yelp_data, function( index, value ) {

        var result_address = (value.address != "") ? value.address : "-" ;
        var reslut_contact =  (value.contact != "") ? value.contact : "-" ;
        var reslut_email =  (value.email != "") ? value.email : "-" ;
        var reslut_geo =  (value.geo != "") ? value.geo : "-" ;
        var reslut_logo =  (value.logo != "") ? value.logo : "-" ;

        yelp_html += '<tr> <th scope="row">'+(index+1)+'</th> <td>'+value.name+'</td><td><a href="'+value.website +'" target="_blank">Link</a></td><td>'+ result_address +'</td><th>'+reslut_contact+'</th><td>'+value.description+'</td><td>'+reslut_email+'</td><td>'+reslut_geo+'</td><td>'+reslut_logo
        +'</td></tr>';

        });


        $("#yelp_list").html(yelp_html);

        $.each(result.houzz_data, function( index, value ) {
        var result_address = (value.address != "") ? value.address : "-" ;
        var reslut_contact =  (value.contact != "") ? value.contact : "-" ;
        var reslut_email =  (value.email != "") ? value.email : "-" ;
        var reslut_geo =  (value.geo != "") ? value.geo : "-" ;
        var reslut_logo =  (value.logo != "") ? value.logo : "-" ;
        houzz_html += '<tr> <th scope="row">'+(index+1)+'</th> <td>'+value.name+'</td><td><a href="'+value.website +'" target="_blank">Link</a></td><td>'+ result_address +'</td><th>'+reslut_contact+'</th><td>'+value.description+'</td><td>'+reslut_email+'</td><td>'+reslut_geo+'</td><td>'+reslut_logo
        +'</td></tr>';

        });


        $("#houzz_list").html(houzz_html);

      }
    });

    
}

        
    </script>
</html>